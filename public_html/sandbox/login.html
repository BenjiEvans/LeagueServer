<!DOCTYPE html>
<html>
<head>
  <title>Modal</title>
  <link rel="stylesheet" type="text/css" href="../css/bootstrap/bootstrap.min.css">
<script src="../js/jquery/jquery.min.js"></script>
</head>
<body>

<!-- Scripting functions -->

<script>



$(document).ready(function(){
   
    $('#termbox').click(function(){
         
           $("#register").attr('disabled', !this.checked)
         
      });

    $('#terms').click(function(){

           $('#conditions').removeClass("hidden");
           $('#conditions').addClass("show");

      });

    $('#login').click(function(){
  
           login(); 

       });

    $('#register').click(function(){
  
           register(); 

     });


//ensure that no feilds are empty 
   $('.form-control').blur(function(){
            
         
          checkForEmptyField($(this));
        
              
    });

  $('#register_email').blur(function(){
           
     doEmailCheck($(this));

  });

  $('#register_cemail').blur(function(){
        
        checkEmailConfirm();

   });

  $()


});


function login(){

	//check email for emptyness
	var email = $('#login_email');
	if(email.hasClass("has-error"))return;
	
	if(isEmpty(email.val())){	
		email.parent().addClass("has-error");
		$('#login_error').html("Please enter email id or if new user click Register");
		return;
	}
	
	
	//check password for emptiness
	var password =$('#login_pass');
	if (password.hasClass("has-error"))return;
	
	if (isEmpty(password.val())){
		password.parent().addClass("has-error");
		$('#login_error').html("Please enter password");
		return;
	}
	
	//create JSON
	var login_parameter ={
	email:email.val(),
	pass: password.val()
	}
	
	
	//Create AJAX call to Server
	$.ajax({
                 type: "POST",
                 url: "../login.php",
	             data: JSON.stringify(login_parameter),
                 contentType: "application/json; charset=utf-8",
                 dataType: "json",
                 processData: true,
                 success: function () {
                     //window.location.href="../officer.php";	
					 
					 alert("Hi");
                 },
                 error: function () {
                    alert("error");
                 }
             });



}

function checkForEmptyField(field){

 if(isEmpty(field.val())) field.parent().addClass("has-error");
 else field.parent().removeClass("has-error");

}

function doEmailCheck(email){

//if the email is invalid display error
     if(!validEmail(email.val().trim())){
          
       displayEmailError();
        return;
     }
      
//other wise there are no erros (success) 

  //remove errors and warning s
       email.parent().removeClass('has-error has-warning');
       $("#email_error").html("");
       email.parent().addClass('has-success');
        checkEmailConfirm();


}


function isEmpty(string){

return string.trim().length == 0;

}

function checkEmailConfirm(){

checkStatus($('#register_email'),$('#register_cemail'));

}

function checkPassConfirm(){
checkStatus($('#register_pass'),$('#register_cpass'));
}

function checkStatus(field, confirm_field){

if(field.hasClass("has-error") || isEmpty(field.val())){

confirm_field.parent().removeClass("has-warning has-error has-success");
return;
}

if(confirm_field.val().trim() == field.val().trim()){

confirm_field.parent().removeClass("has-warning has-error");
confirm_field.parent().addClass("has-success");

}
else confirm_field.parent().addClass("has-warning");


}

function register(){

//return if any fields are empty or has errors
var list = document.getElementsByClassName('form-control');
var hasError = false;
for( var i = 0, length = list.length; i < length; i++){

    var element = list[i];

  if(hasClass(element,"reg") && (isEmpty(element.value) || hasClass(element.parentNode,"has-error") || hasClass(element.parentNode, "has-warning"))){

       if(!hasError) hasError= true;
       element.parentNode.className =  element.parentNode.className +" has-error";
  }

}

if(hasError)return;


alert("Data has been sent to server");
}

function displayEmailError(){
var email = $('#register_email');
var parent = email.parent();
$("#email_error").html("*not a proper email format");
parent.removeClass("has-success");
parent.addClass("has-error");
$('#register_cemail').parent().removeClass("has-success");
}

function hasClass(element, cls) {
    return (' ' + element.className + ' ').indexOf(' ' + cls + ' ') > -1;
}

function validEmail(email) { 
    var re = /^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
    return re.test(email);
} 


</script>




<div class="container">

  <div class="page-header">
    <h1>Modal <small>Bootstrap Visual Test</small></h1>
  </div>

<!-- Login Modal Start---->
  <div id="login_modal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="login_modal_label" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">

        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
          <h4 class="modal-title" id="login_modal_label">Login</h4>
        </div>
        <div class="modal-body">
        <form role="form">
		  <div class="form-group">
			<label for="login_email">Email address</label>
			<input type="email" class="form-control" id="login_email" placeholder="Enter email">		
		  </div>
	  
		  <div class="form-group">
			<label for="login_pass">Password</label>
			<input type="password" class="form-control" id="login_pass" placeholder="Password">
		  </div>
		  <div class="checkbox" >
			<label>
			  <input type="checkbox"> Remember me
			</label>		
		  </div>
		  <br><span id='login_error'> </span>
	  
		</form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-warning" style='float:left' data-dismiss="modal" data-toggle="modal" data-target="#register_modal">Register</button>
          <button id='login' type="button" class="btn btn-primary">Login</button>
          <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>
<!-- login modalEnd --->

<!-- register modal start --->

<div id="register_modal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="register_modal_label" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">

        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
          <h4 class="modal-title" id="register_modal_label">Register</h4>
        </div>
        <div class="modal-body">
        <form role="form">
          <div class="form-group">
	    <label for="register_username">Username</label>
	    <input type="email" class="form-control reg" id="register_username" placeholder="In game name">
	  </div>
	  <div class="form-group">
	    <label class="control-label" for="register_email">Email address </label> 
	    <input type="email" class="form-control reg" id="register_email" placeholder="Enter email">
            <span id='email_error' class='control-label'></span>
	  </div>
          <div class="form-group">
	    <label class="control-label" for="register_cemail">Confirm Email </label>
	    <input type="email" class="form-control reg" id="register_cemail" placeholder="Confirm email">
	  </div>
	  <div class="form-group">
	    <label class="control-label" for="register_pass">Password</label>
	    <input type="password" class="form-control reg" id="register_pass" placeholder="Password">
	  </div>
           <div class="form-group">
	    <label class="control-label" for="register_cpass">Confirm Password</label>
	    <input type="password" class="form-control reg" id="register_cpass" placeholder="Password">
	  </div>
          <div class="checkbox">
	    <label>
	      <input id='termbox' type="checkbox"> <small>By clicking Sign Up, you agree to our <a id='terms'>Terms and Policy</a> of use</small>
	    </label>
	  </div>
           <div>
            <p id='conditions' class="bg-danger hidden"> Terms go here...</p>
           </div>
	</form>
        </div>
        <div class="modal-footer">
          <button id='register' type="button" class="btn btn-warning" style='float:left' disabled >Signup</button>
        </div>

      </div>
    </div>
  </div>

<!-- register modal end ----->


  <button class="btn btn-primary btn-lg" data-toggle="modal" data-target="#login_modal">
    Launch demo modal
  </button>

</div>

<!-- JavaScript Includes -->

<script src="../js/bootstrap/transition.js"></script>
<script src="../js/bootstrap/modal.js"></script>
<script src="../js/bootstrap/tooltip.js"></script>
<script src="../js/bootstrap/popover.js"></script>

</body>
</html>
